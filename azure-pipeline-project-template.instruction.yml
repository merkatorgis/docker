# Note: to provision this project with all the needed repositories, code, policies, pipelines, etc,
# the pipeline needs to run (once) with the credentials of a project administrator.

# 1. Create a new DevOps project.

# 2. Initialise the new project's default repo:
# Click Repos (center left), then click Initialize (bottom right).

# 3. Create a Personal Access Token (PAT):
# As an Administrator of this DevOps Project, create a PAT with scope "full access".
# See for instructions: https://learn.microsoft.com/en-us/azure/devops/organizations/accounts/use-personal-access-tokens-to-authenticate?toc=%2Fazure%2Fdevops%2Forganizations%2Ftoc.json&view=azure-devops&tabs=Windows

# 4. Create the pipeline:
# Click Pipelines (center left) | Create pipeline | Azure Repos Git | {this project's default repo} | Starter pipeline
# Delete the starter pipline content, replacing it with the contents of the file you're reading now.
# Click Variables (top right) | New variable -> Name: PAT, Value: {the PAT you created}, check Keep this value secret
# Clik OK | Save to save the new variable.

# 5. Save and Run the pipeline:
# Click Save and run, accept the defaults by again clicking Save and Run, and the pipeline will run.
# Click on the "Provision docker4gis template" job to see what's happening.

# 6. Remove the initial repo & pipeline:
# Click Project settings (bottom left) | Repositories (scroll down to find it).
# Click the repository with the same name as the project.
# Click the three dots (top right), and click Delete.
# Type the repository's name to confirm, and click Delete.
# Now click Pipelines (center left), and follow the same steps to delete this pipeline,
# which will also delete the PAT variable(!).
